<!DOCTYPE html>
<html>
<head>
	<title>Dice</title>
	<link rel="icon" href="../assets/images/icon.png">
	<meta name="robots" content="noindex">
	<style>
		.smalltextbox{
			width: 50px;
			text-align: left;
			vertical-align: text-top; <!-->aligns labels to top of text box</!-->
		}
	</style>
</head>
<body>
	<div id = "diceOptions">
		<div id = "die_0">
			<input type="number" id="qty0" value = "0" min = "0" class = "smalltextbox" onchange="updateRoll(0)">
			<select id="die0" name="variable" onchange="updateRoll(0)">
				<option value="0" disabled selected>Select a die</option>
				<option value="2">d2</option>
				<option value="3">d3</option>
				<option value="4">d4</option>
				<option value="6">d6</option>
				<option value="8">d8</option>
				<option value="10">d10</option>
				<option value="12">d12</option>
				<option value="20">d20</option>
				<option value="100">d100</option>
			</select>
			+
			<input type="number" id="add0" value = "0" min = "0" class = "smalltextbox" onchange="updateRoll(0)">
			<button onclick="roll(0)">Roll</button>
			<div id = "diceRoll0">0d0 + 0</div>
		</div>
	</div>
	<button onclick="rollAll()" hidden="hidden" id = "roleAllButton">Roll All</button>
	<br>
	<button onclick="addDie()">+</button>
	<br>
	<canvas id="canvas" height="300" width="300"></canvas>
	<p id = "diceRoll"></p>
</body>
	
<script>
	//d2, d3, d4, d6, d8, d10, d12, d20, d100
	//number of said dice
	//additional value
	let currentDie = [0]
	function updateRoll(rollNum){
		let qty = document.getElementById("qty"+rollNum).value
		let add = document.getElementById("add"+rollNum).value
		let die = document.getElementById("die"+rollNum).value
		if(qty<0) qty = 0
		if(add<0) add = 0
		let diceRoll = qty + "d" + die + " + " + add
		
		document.getElementById("qty"+rollNum).value = qty
		document.getElementById("add"+rollNum).value = add
		document.getElementById("diceRoll"+rollNum).innerHTML = diceRoll
	}
	
	function roll(rollNum){
		let qty = document.getElementById("qty" + rollNum).value
		let add = document.getElementById("add" + rollNum).value
		let die = document.getElementById("die" + rollNum).value
		let diceRoll = qty + "d" + die + " + " + add
		let result = 0;
		for(let i = 0; i< qty;i++){
			result += Math.floor(Math.random() * die) + 1
		}
		result+= + add;
		console.log(result)
	}
	
	function addDie(){
		let currentSettings = []
		for (let i = 0; i< currentDie.length; i++){
			currentSettings.push([
				document.getElementById("qty" + currentDie[i]).value,
				document.getElementById("add" + currentDie[i]).value,
				document.getElementById("die" + currentDie[i]).value
			])
		}
		let nextDie = currentDie[currentDie.length-1]+1
		currentDie.push(nextDie)
		document.getElementById("diceOptions").innerHTML =""
		
		for (let i = 0; i< currentDie.length; i++){
			document.getElementById("diceOptions").innerHTML += '<div id = "die_'+currentDie[i]+'"><input type="number" id="qty'+currentDie[i]+'" value = "0" min = "0" class = "smalltextbox" onchange="updateRoll('+currentDie[i]+')"><select id="die'+currentDie[i]+'" name="variable" onchange="updateRoll('+currentDie[i]+')"><option value="0" disabled selected>Select a die</option><option value="2">d2</option><option value="3">d3</option><option value="4">d4</option><option value="6">d6</option><option value="8">d8</option><option value="10">d10</option><option value="12">d12</option><option value="20">d20</option><option value="100">d100</option></select>+<input type="number" id="add'+currentDie[i]+'" value = "0" min = "0" class = "smalltextbox" onchange="updateRoll('+currentDie[i]+')"><button onclick="roll('+currentDie[i]+')">Roll</button><div id = "diceRoll'+currentDie[i]+'">0d0 + 0</div></div>'
		}
		document.getElementById("roleAllButton").removeAttribute("hidden")
	}
	
</script>
</html>